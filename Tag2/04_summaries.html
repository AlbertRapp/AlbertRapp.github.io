<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.165">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Albert Rapp">
  <title>WiWi BrushUp Kurs 2022</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="04_summaries_files/libs/clipboard/clipboard.min.js"></script>
  <script src="04_summaries_files/libs/quarto-html/quarto.js"></script>
  <script src="04_summaries_files/libs/quarto-html/popper.min.js"></script>
  <script src="04_summaries_files/libs/quarto-html/tippy.umd.min.js"></script>
  <script src="04_summaries_files/libs/quarto-html/anchor.min.js"></script>
  <link href="04_summaries_files/libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="04_summaries_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="04_summaries_files/libs/bootstrap/bootstrap.min.js"></script>
  <link href="04_summaries_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="04_summaries_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Inhaltsverzeichnis</h2>
<ul>
<li><a href="#zielsetzung" class="nav-link active" data-scroll-target="#zielsetzung">Zielsetzung</a></li>
<li><a href="#aufgaben" class="nav-link" data-scroll-target="#aufgaben">Aufgaben</a>
<ul class="collapse">
<li><a href="#zusammenfassungen-für-den-kompletten-datensatz" class="nav-link" data-scroll-target="#zusammenfassungen-für-den-kompletten-datensatz">Zusammenfassungen für den kompletten Datensatz</a></li>
<li><a href="#zusammenfassung-für-eine-untergruppe" class="nav-link" data-scroll-target="#zusammenfassung-für-eine-untergruppe">Zusammenfassung für eine Untergruppe</a></li>
<li><a href="#zusammenfassung-für-mehrere-untergruppen" class="nav-link" data-scroll-target="#zusammenfassung-für-mehrere-untergruppen">Zusammenfassung für mehrere Untergruppen</a></li>
</ul></li>
</ul>
</nav>
</div>
<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">




<div class="quarto-title"><h1 class="title display-7">WiWi BrushUp Kurs 2022</h1><p class="subtitle lead">Ames Housing - Zusammenfassungen</p></div><div class="quarto-title-meta"><div><div class="quarto-title-meta-heading">Author</div><div class="quarto-title-meta-contents"><div class="quarto-title-authors"><div><div>
<p>Albert Rapp</p>
</div></div></div></div></div><div><div class="quarto-title-meta-heading">Published</div><div class="quarto-title-meta-contents"><p class="date">April 13, 2022</p></div></div></div></header>

<section id="zielsetzung" class="level1">
<h1>Zielsetzung</h1>
<p>Unser Ziel ist einfach.</p>
<p><strong>Schritt 1:</strong></p>
<p><strong>Schritt 2:</strong></p>
</section>
<section id="aufgaben" class="level1">
<h1>Aufgaben</h1>
<p>In dem letzten Tutorial haben wir neue Variablen aus bereits bekannten Größen berechnet. Manchmal will man einen Datensatz aber nicht noch vergrößern. Manchmal will man einfach nur Kennzahlen, die einen Datensatz zusammenfassen. Betrachen wir dazu wieder unseren Ames Housing Datensatz.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames, <span class="at">package =</span> <span class="st">'modeldata'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ames_teil <span class="ot">&lt;-</span> ames <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sale_price, lot_area, ms_zoning, neighborhood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="zusammenfassungen-für-den-kompletten-datensatz" class="level2">
<h2 class="anchored" data-anchor-id="zusammenfassungen-für-den-kompletten-datensatz">Zusammenfassungen für den kompletten Datensatz</h2>
<p>Da wir Vektoren mittlerweile mühelos extrahieren können, können wir diese Vektoren durch Statistiken zusammenfassen. Beispielsweise könnten wir den Durchschnitt oder den Median eines Vektors schätzen. Andere Statistiken könnten sich mit der Streuung einer Variable beschäftigen. In diese Kategorie gehören Varianz und Standardabweichung. Nutze nun den <code>$</code> Operator, um <code>sale_price</code> zu extrahieren. Anschließend kannst du die Funktionen <code>mean()</code>, <code>median()</code>, <code>var()</code> und <code>sd()</code> verwenden, um Kennzahlen für den Verkaufspreise zu schätzen.</p>
<div class="cell">
<pre><code>## [1] 180796.1
## [1] 160000
## [1] 6381883616
## [1] 79886.69</code></pre>
</div>
<p>Nutze nun <code>summarise()</code>, um diese Größen in einem tibble <code>ames_summaries</code> zu sammeln.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ames_summaries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 x 4
  durchschnitt median     varianz std_abw
         &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
1      180796. 160000 6381883616.  79887.</code></pre>
</div>
</div>
</section>
<section id="zusammenfassung-für-eine-untergruppe" class="level2">
<h2 class="anchored" data-anchor-id="zusammenfassung-für-eine-untergruppe">Zusammenfassung für eine Untergruppe</h2>
<p>Berechne nun analog dazu die Größen für jede Nachbarschaft und speichere dies in einem tibble <code>ames_by_neighborhood</code>. Ordne diesen tibble außerdem nach absteigendem Durchschnittspreis.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ames_by_neighborhood</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 28 x 6
   neighborhood       durchschnitt  median      varianz std_abw Anzahl
   &lt;fct&gt;                     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;int&gt;
 1 Northridge              330319. 302000  10291019636. 101445.     71
 2 Stone_Brook             324229. 319000  14226053465. 119273.     51
 3 Northridge_Heights      322018. 317750   9203016597.  95932.    166
 4 Green_Hills             280000  280000   5000000000   70711.      2
 5 Veenker                 248315. 250250   4286969017.  65475.     24
 6 Timberland              246600. 232106.  4806159657.  69326.     72
 7 Somerset                229707. 225500   3299054067.  57437.    182
 8 Clear_Creek             208662. 197500   2629660293.  51280.     44
 9 Crawford                207551. 200624   4254976811.  65230.    103
10 College_Creek           201803. 200000   2936322410.  54188.    267
# ... with 18 more rows</code></pre>
</div>
</div>
<p>Diesen Datensatz können wir nun zusammen mit dem Datensatz <code>ames_teil</code> verwenden, um eine Grafik mit Zusammenfassung und allen Datenpunkten zu zeigen. Wir wollen, dass diese Grafik aufsteigend sortiert ist, damit schnell ersichtlich ist, was das teuerste Viertel ist. Dazu transformieren wir <code>neighborhood</code> ins so genannte <code>factor</code> Format. Dies ist ein spezielle Format, dass kategorielle Variablen eine Ordnung geben kann. In diesem Fall machen wir dies mit <code>fct_reorder()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ames_teil <span class="ot">&lt;-</span> ames_teil <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neighborhood =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> neighborhood, <span class="at">.x =</span> sale_price, <span class="at">.fun =</span> median))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ames_teil<span class="sc">$</span>neighborhood[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code> [1] North_Ames     North_Ames     North_Ames     North_Ames     Gilbert       
 [6] Gilbert        Stone_Brook    Stone_Brook    Stone_Brook    Gilbert       
[11] Gilbert        Gilbert        Gilbert        Gilbert        Stone_Brook   
[16] Stone_Brook    Gilbert        Stone_Brook    Gilbert        Northwest_Ames
[21] Northwest_Ames Northwest_Ames Somerset       North_Ames     North_Ames    
29 Levels: Meadow_Village Briardale Iowa_DOT_and_Rail_Road Old_Town ... Hayden_Lake</code></pre>
</div>
</div>
<p>Wie du siehst, hat der Vektoroutput nun zusätzlich “29 Levels: …” generiert. Dies ist das Zeichen, dass hier ein <code>factor</code> vorliegt und die zulässigen Kategorien in diesm Vektor durch die 29 Nachbarschaften gegeben sind. <code>fct_reorder()</code> hat außerdem dafür gesorgt, dass in dem Vektor nun eine Reihenfolge der Kategorien nach dem <code>median</code> des <code>sale_price</code> hinterlegt ist. Dies wurde über die Argumente <code>.x</code> und <code>.fun</code> gesteuert. Nun können wir <code>ames_teil</code> zusammen mit <code>ames_by_neighborhood</code> in eine Grafik stecken. Die Idee hinter der Grafik kommt übrigens von <a href="https://www.cedricscherer.com/2019/05/17/the-evolution-of-a-ggplot-ep.-1/#polish">Cédric Scherer</a>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_summaries_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="zusammenfassung-für-mehrere-untergruppen" class="level2">
<h2 class="anchored" data-anchor-id="zusammenfassung-für-mehrere-untergruppen">Zusammenfassung für mehrere Untergruppen</h2>
<p>Auf die gleiche Art und Weise können wir auch für gemischte Untergruppen Kennzahlen berechnen. Lass uns dazu aus dem <code>ames</code> Datensatz die Medianpreise gemäß dem Zustand und der Lage des Hauses berechnen. Speichere die Berechnungen in der Variable <code>ames_cond_neighborhood</code> und sortiere den Datensatz absteigend nach dem Medianpreis.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ames_cond_neighborhood</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 146 x 3
   overall_cond neighborhood                             median
   &lt;fct&gt;        &lt;fct&gt;                                     &lt;dbl&gt;
 1 Very_Poor    Old_Town                                 62500 
 2 Very_Poor    Edwards                                  61000 
 3 Very_Poor    Iowa_DOT_and_Rail_Road                   76500 
 4 Very_Poor    South_and_West_of_Iowa_State_University  93369 
 5 Poor         Old_Town                                 49894.
 6 Poor         Gilbert                                 115000 
 7 Poor         Sawyer                                   63900 
 8 Poor         Mitchell                                159000 
 9 Poor         Brookside                                76500 
10 Poor         Iowa_DOT_and_Rail_Road                   76000 
# ... with 136 more rows</code></pre>
</div>
</div>
<p>Krass. Stone Brook muss ein extrem teures Viertel sein. Selbst Häuser der Qualität <code>Poor</code> sind extrem teuer. Tatsächlich behauptet hier die Analyse, dass diese Häuser im Mittel sogar teurer sind als die Häuser von besserer Qualität im gleichen Viertel. Da kann irgendetwas nicht stimmen. Führe diese Analyse nochmals durch, aber lass diesmal die Gruppengröße ebenfalls berechnen.</p>
<div class="cell">
<div class="cell-output-stdout">
<pre><code># A tibble: 146 x 4
   overall_cond neighborhood                             median Anzahl
   &lt;fct&gt;        &lt;fct&gt;                                     &lt;dbl&gt;  &lt;int&gt;
 1 Very_Poor    Old_Town                                 62500       3
 2 Very_Poor    Edwards                                  61000       1
 3 Very_Poor    Iowa_DOT_and_Rail_Road                   76500       2
 4 Very_Poor    South_and_West_of_Iowa_State_University  93369       1
 5 Poor         Old_Town                                 49894.      2
 6 Poor         Gilbert                                 115000       1
 7 Poor         Sawyer                                   63900       1
 8 Poor         Mitchell                                159000       1
 9 Poor         Brookside                                76500       1
10 Poor         Iowa_DOT_and_Rail_Road                   76000       2
# ... with 136 more rows</code></pre>
</div>
</div>
<p>Aha! Da liegt also der Hund begraben. Viele der Gruppen haben eine ziemlich kleine Größe. Damit sind manche “Mittelwerte” eher zweifelshafte Schätzungen. Filtern wir die doch mal raus. Nehmen wir dazu eine Grenze von mindestens 25 Häusern.</p>
<div class="cell">
<div class="cell-output-stdout">
<pre><code># A tibble: 30 x 4
   overall_cond neighborhood       median Anzahl
   &lt;fct&gt;        &lt;fct&gt;               &lt;dbl&gt;  &lt;int&gt;
 1 Average      North_Ames         136300    167
 2 Average      College_Creek      207000    226
 3 Average      Old_Town           112500     45
 4 Average      Edwards            127500     82
 5 Average      Somerset           225500    178
 6 Average      Northridge_Heights 318000    165
 7 Average      Gilbert            183500    151
 8 Average      Sawyer             134000     61
 9 Average      Northwest_Ames     172500     47
10 Average      Sawyer_West        183000    104
# ... with 20 more rows</code></pre>
</div>
</div>
<p>Na das siehst doch schon besser aus. Aber es gibt vermutlich immer noch ein paar Ungereimtheiten, die man sich angucken könnten. Trotzdem konnten wir durch die zusätzliche Betrachtung der Gruppengröße schon mal sehr auffällige “Fehler” bereinigen.</p>

</section>
</section>
</main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->


</body></html>